<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="_9xEKt0wCBtpShn_Al_zxk3WKufJzzCvbmsr0ZZ4ISk" />
  <title>Oral Sex Story Hindi</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background-color: #f5ecd8;
      margin: 0;
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      text-align: center;
      color: #4a2c1e;
      font-size: 24px;
      margin: 10px 0;
      width: 100%;
      max-width: 800px;
    }
    h1 span {
      font-size: 16px;
      color: #4a2c1e;
    }
    .nav-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #d2b48c;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 20px;
      width: 100%;
      max-width: 800px;
      flex-wrap: wrap;
    }
    .nav-bar select {
      width: 45%;
      padding: 5px;
      border: none;
      background-color: #d2b48c;
      color: #4a2c1e;
      font-size: 16px;
      text-align: center;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      cursor: pointer;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%234a2c1e" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position: right 10px center;
    }
    .nav-bar input[type="text"] {
      width: 45%;
      padding: 5px;
      border: none;
      border-radius: 3px;
      background-color: #fff;
      color: #4a2c1e;
      font-size: 16px;
      text-align: center;
    }
    .nav-bar input[type="text"]::placeholder {
      color: #4a2c1e;
      opacity: 0.7;
    }
    .nav-bar a {
      color: #4a2c1e;
      text-decoration: none;
      font-size: 16px;
    }
    .nav-bar a:hover {
      text-decoration: underline;
    }
    .container {
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .post {
      background-color: #fff;
      border-radius: 5px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      cursor: pointer;
      width: 100%;
      max-width: 800px;
    }
    .post:hover {
      background-color: #f9f9f9;
    }
    .post-position {
      font-size: 16px;
      font-weight: bold;
      color: #4a2c1e;
      margin-bottom: 10px;
      text-align: center;
    }
    .post-title {
      font-size: 18px;
      color: #4a2c1e;
      margin: 0 0 10px;
      overflow-wrap: break-word;
      word-break: break-word;
      hyphens: auto;
      text-align: center;
    }
    .post-title:hover {
      color: #6b3e26;
    }
    .post-message {
      font-size: 16px;
      color: #34495e;
      margin-bottom: 10px;
      overflow-wrap: break-word;
      word-break: break-word;
      hyphens: auto;
      text-align: center;
    }
    .post-tags {
      font-size: 14px;
      color: #666;
      overflow-wrap: break-word;
      word-break: break-word;
      hyphens: auto;
      text-align: center;
    }
    .post-tags span {
      color: #4a2c1e;
      margin-right: 5px;
      white-space: nowrap;
    }
    .error {
      color: #e74c3c;
      text-align: center;
      font-size: 16px;
      padding: 20px;
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 800px;
    }
    .speech-error {
      color: #e74c3c;
      font-size: 14px;
      text-align: center;
      margin: 10px 0;
    }
    .play-button, .share-button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 20px;
      color: #4a2c1e;
      margin: 10px 5px;
      display: inline-block;
      transition: color 0.3s;
    }
    .play-button:hover, .share-button:hover {
      color: #6b3e26;
    }
    .play-button.playing {
      color: #e74c3c;
    }
    .play-button:disabled {
      color: #ccc;
      cursor: not-allowed;
    }
    .share-button {
      font-size: 18px;
    }
    .hide-telegram-link {
      display: flex;
      justify-content: center;
      width: 100%;
      margin: 10px 0;
    }
    .hide-telegram-link a {
      display: inline-block;
    }
    .hide-telegram-link img {
      width: 100%;
      max-width: 150px;
      height: auto;
      cursor: pointer;
    }
    /* Toast Notification Styling */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #e74c3c;
      color: #fff;
      padding: 10px 20px;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      font-size: 16px;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    .toast.show {
      opacity: 1;
    }
    /* Advertisement Styling */
    .ad-container {
      margin-top: 15px;
      text-align: center;
      width: 100%;
    }
    .ad-container a {
      display: inline-block;
      text-decoration: none;
    }
    .ad-container img {
      width: 100%;
      max-width: 300px; /* Adjust max-width as needed */
      height: auto;
      border-radius: 5px;
      display: block;
      margin: 0 auto;
    }
    @media (max-width: 600px) {
      .post {
        padding: 10px;
      }
      .post-position {
        font-size: 14px;
      }
      .post-title {
        font-size: 16px;
      }
      .post-message {
        font-size: 14px;
      }
      .post-tags {
        font-size: 12px;
      }
      .play-button, .share-button {
        font-size: 18px;
      }
      .speech-error {
        font-size: 12px;
      }
      .nav-bar select, .nav-bar input[type="text"] {
        width: 100%;
        margin-bottom: 10px;
      }
      .hide-telegram-link img {
        max-width: 120px;
      }
      .toast {
        width: 90%;
        font-size: 14px;
        text-align: center;
      }
      .ad-container img {
        max-width: 200px; /* Smaller max-width for mobile */
      }
    }
  </style>
</head>
<body>
  <h1>Oral Sex Story Hindi <br> <span>अंतर्वासना सेक्स कहानियाँ</span></h1>
  <div class="nav-bar">
    <select id="tag-filter">
      <option value="">All Tags ▼</option>
    </select>

    <div class="hide-telegram-link">
      <a href="https://lnk.ec/oUJejM" target="_blank">
        <img src="https://raw.githubusercontent.com/diya4002/Storys/refs/heads/main/tg.png" alt="Join Our Telegram Group" style="width: 100%; max-width: 150px; height: auto; cursor: pointer;">
      </a>
    </div>
    <input type="text" id="search-input" placeholder="Search posts...">
  </div>

  <div class="container" id="data-container">
  </div>

  <script>
    // OpenSheet API URL (Ensure this Google Sheet is publicly shared)
    const SHEET_JSON_URL = 'https://opensheet.elk.sh/12ztLodAK-rcTxscpNl5Niyo5tByci6hvkXSpYfse4uQ/Sheet1';

    // Advertisement variables
    const adsimage = 'https://raw.githubusercontent.com/diya4002/Storys/refs/heads/main/ms_023d5_512_491582502.jpg';
    const aadsherflink = 'https://lnk.ec/z_P-i_';

    // Store fetched data globally
    let allPosts = [];

    // Global variable to track if any speech is active
    let isSpeaking = false;

    // Global variable to track the currently expanded post
    let currentlyExpandedPostId = null;

    // Sample data as a fallback
    const sampleData = [
      {
        Title: "Sample Story 1",
        Message: "This is a sample story message. It has multiple sentences. Each sentence should be read separately. This is to test the line-by-line reading feature.",
        Tags: "romance, drama"
      },
      {
        Title: "Sample Story 2",
        Message: "A shorter message. It has two sentences. Let's see how it works.",
        Tags: "comedy, love"
      }
    ];

    // Function to show toast notification
    function showToast(message) {
      let toast = document.querySelector('.toast');
      if (!toast) {
        toast = document.createElement('div');
        toast.className = 'toast';
        document.body.appendChild(toast);
      }
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
          toast.remove();
        }, 300);
      }, 3000);
    }

    // Fetch and process JSON data with timeout
    function fetchSheetData() {
      const container = document.getElementById('data-container');
      container.innerHTML = '<div style="text-align: center; padding: 20px;">Loading data...</div>';

      // Create a timeout for the fetch request
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 10000); // 10-second timeout

      fetch(SHEET_JSON_URL, { signal: controller.signal })
        .then(response => {
          clearTimeout(timeoutId);
          if (!response.ok) {
            throw new Error(`Network response was not ok: ${response.status} - ${response.statusText}`);
          }
          return response.json();
        })
        .then(data => {
          console.log('Fetched data:', data);
          if (data && data.length > 0) {
            allPosts = data;
            populateTagFilter();
            displayPostsByFragment();
          } else {
            console.warn('No data found in Google Sheet, using sample data instead.');
            allPosts = sampleData;
            populateTagFilter();
            displayPostsByFragment();
          }
        })
        .catch(error => {
          console.error('Error fetching data:', error);
          displayError(`Error fetching data: ${error.message}. Using sample data instead. Please ensure the Google Sheet is publicly shared and the URL is correct.`);
          allPosts = sampleData;
          populateTagFilter();
          displayPostsByFragment();
        });
    }

    // Populate the tag filter dropdown
    function populateTagFilter() {
      const select = document.getElementById('tag-filter');
      select.innerHTML = '<option value="">All Tags ▼</option>';
      const allTags = new Set();
      allPosts.forEach(row => {
        if (row.Tags) {
          row.Tags.split(',').map(tag => tag.trim()).forEach(tag => allTags.add(tag));
        }
      });
      const sortedTags = Array.from(allTags).sort((a, b) => a.localeCompare(b));
      sortedTags.forEach(tag => {
        const option = document.createElement('option');
        option.value = tag;
        option.textContent = tag;
        select.appendChild(option);
      });
      select.addEventListener('change', filterPostsByTag);
    }

    // Filter posts based on selected tag and search query
    function filterPostsByTag() {
      const selectedTag = document.getElementById('tag-filter').value;
      const searchQuery = document.getElementById('search-input').value.toLowerCase();
      let filteredPosts = allPosts;

      if (selectedTag) {
        filteredPosts = allPosts.filter(row => {
          if (!row.Tags) return false;
          const tags = row.Tags.split(',').map(tag => tag.trim());
          return tags.includes(selectedTag);
        });
      }

      if (searchQuery) {
        filteredPosts = filteredPosts.filter(row => {
          const title = (row.Title || '').toLowerCase();
          const message = (row.Message || '').toLowerCase();
          const tags = (row.Tags || '').toLowerCase();
          return title.includes(searchQuery) || message.includes(searchQuery) || tags.includes(searchQuery);
        });
      }

      const postsWithIndices = filteredPosts.map(row => {
        const originalIndex = allPosts.indexOf(row);
        const originalPosition = originalIndex + 1;
        return {
          row,
          originalIndex,
          originalPosition
        };
      }).sort((a, b) => b.originalIndex - a.originalIndex);

      displayPosts(postsWithIndices);
    }

    // Setup search input
    function setupSearch() {
      const searchInput = document.getElementById('search-input');
      searchInput.addEventListener('input', filterPostsByTag);
    }

    // Split message into lines for speech
    function splitIntoLines(text) {
      if (!text) return ['No message provided'];
      const sentences = text.match(/[^.!?]+[.!?]|\S+/g) || [text];
      return sentences.map(s => s.trim()).filter(s => s);
    }

    // Display posts based on URL fragment
    function displayPostsByFragment() {
      const fragment = window.location.hash;
      if (fragment && fragment.startsWith('#post-')) {
        const postId = parseInt(fragment.replace('#post-', ''));
        const postIndex = postId - 1;
        if (postIndex >= 0 && postIndex < allPosts.length) {
          displayPosts([{ row: allPosts[postIndex], originalIndex: postIndex, originalPosition: postId }], postId);
        } else {
          displayError(`Post with ID ${postId} not found.`);
        }
      } else {
        const postsWithIndices = allPosts.map((row, index) => ({
          row,
          originalIndex: index,
          originalPosition: index + 1
        })).sort((a, b) => b.originalIndex - a.originalIndex);
        displayPosts(postsWithIndices);
      }
    }

    // Display posts
    function displayPosts(postsWithIndices, forcedPosition = null) {
      const container = document.getElementById('data-container');
      container.innerHTML = '';
      if (postsWithIndices.length === 0) {
        container.innerHTML = '<div class="error">No posts found for the selected tag or search query.</div>';
        return;
      }
      postsWithIndices.forEach(({ row, originalIndex, originalPosition }) => {
        const position = forcedPosition !== null ? forcedPosition : originalPosition;
        const title = row.Title;
        let message = row.Message || 'No message provided';
        const tags = row.Tags;
        const postDiv = document.createElement('div');
        postDiv.className = 'post';
        postDiv.id = `post-${position}`;
        let isExpanded = forcedPosition !== null;

        const positionElement = document.createElement('div');
        positionElement.className = 'post-position';
        positionElement.textContent = `#${position}`;
        postDiv.appendChild(positionElement);

        const titleElement = document.createElement('h2');
        titleElement.className = 'post-title';
        titleElement.textContent = title || 'Untitled';
        postDiv.appendChild(titleElement);

        const messageElement = document.createElement('p');
        messageElement.className = 'post-message';
        const readMoreSpan = document.createElement('strong');
        readMoreSpan.style.cursor = 'pointer';
        readMoreSpan.style.color = '#4a2c1e';
        readMoreSpan.setAttribute('role', 'button');

        // Function to update message display
        function updateMessageDisplay() {
          if (isExpanded) {
            messageElement.textContent = message;
            readMoreSpan.textContent = 'read less';
            readMoreSpan.setAttribute('aria-label', 'Read less');
            currentlyExpandedPostId = `post-${position}`;
          } else {
            if (message.length > 250) {
              const truncatedMessage = message.substring(0, 250);
              messageElement.textContent = `${truncatedMessage}... `;
              readMoreSpan.textContent = 'read more';
              readMoreSpan.setAttribute('aria-label', 'Read more');
            } else {
              messageElement.textContent = message;
              readMoreSpan.textContent = '';
              readMoreSpan.setAttribute('aria-label', '');
            }
            if (isExpanded === false && currentlyExpandedPostId === `post-${position}`) {
              currentlyExpandedPostId = null;
            }
          }
          if (readMoreSpan.textContent) {
            messageElement.appendChild(readMoreSpan);
          }
        }

        // Initial display
        updateMessageDisplay();

        // Toggle on read more/less click
        readMoreSpan.addEventListener('click', (e) => {
          e.stopPropagation();
          if (!isExpanded && currentlyExpandedPostId && currentlyExpandedPostId !== `post-${position}`) {
            showToast('Ek post already pura khula hai. Pehle usse band karo.');
            return;
          }
          isExpanded = !isExpanded;
          updateMessageDisplay();
        });

        postDiv.appendChild(messageElement);

        // Speech synthesis
        if ('speechSynthesis' in window) {
          const playButton = document.createElement('button');
          playButton.className = 'play-button';
          playButton.innerHTML = '▶';
          playButton.setAttribute('aria-label', 'Play audio');
          playButton.setAttribute('tabindex', '0');
          let isPlaying = false;
          let currentLineIndex = 0;
          const lines = splitIntoLines(message);
          let continueReading = false;

          function speakLine() {
            if (!continueReading || currentLineIndex >= lines.length) {
              isPlaying = false;
              continueReading = false;
              isSpeaking = false;
              playButton.innerHTML = '▶';
              playButton.classList.remove('playing');
              playButton.setAttribute('aria-label', 'Play audio');
              currentLineIndex = 0;
              return;
            }

            const textToSpeak = lines[currentLineIndex];
            const utterance = new SpeechSynthesisUtterance(textToSpeak);
            utterance.lang = 'en-US';
            utterance.onend = () => {
              currentLineIndex++;
              if (currentLineIndex >= lines.length) {
                currentLineIndex = 0;
              }
              speakLine();
            };
            window.speechSynthesis.speak(utterance);
            isPlaying = true;
            isSpeaking = true;
            playButton.innerHTML = '⏸';
            playButton.classList.add('playing');
            playButton.setAttribute('aria-label', 'Pause audio');
          }

          playButton.addEventListener('click', (e) => {
            e.stopPropagation();
            const speech = window.speechSynthesis;

            if (isPlaying) {
              speech.cancel();
              isPlaying = false;
              continueReading = false;
              isSpeaking = false;
              playButton.innerHTML = '▶';
              playButton.classList.remove('playing');
              playButton.setAttribute('aria-label', 'Play audio');
            } else {
              if (isSpeaking) {
                showToast('Speak start hai, pehle usse Pause kara.');
                return;
              }
              continueReading = true;
              speakLine();
            }
          });

          postDiv.appendChild(playButton);
        } else {
          const errorMessage = document.createElement('div');
          errorMessage.className = 'speech-error';
          errorMessage.textContent = 'आपका ब्राउज़र स्पीच सपोर्ट नहीं करता है। (Your browser does not support speech.) For speech use chrome browser ya kisi hor browser ka use kara';
          postDiv.appendChild(errorMessage);
        }

        // Share button
        const shareButton = document.createElement('button');
        shareButton.className = 'share-button';
        shareButton.innerHTML = '🔗';
        shareButton.setAttribute('aria-label', 'Share post');
        shareButton.setAttribute('tabindex', '0');
        shareButton.addEventListener('click', (e) => {
          e.stopPropagation();
          const shareUrl = `${window.location.origin}${window.location.pathname}#post-${position}`;
          const shareData = {
            title: title || 'Untitled',
            text: title,
            url: shareUrl
          };

          if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {
            navigator.share(shareData)
              .then(() => console.log('Shared successfully'))
              .catch(err => console.error('Error sharing:', err));
          } else {
            navigator.clipboard.writeText(shareUrl)
              .then(() => alert('Post URL copied to clipboard!'))
              .catch(err => console.error('Failed to copy:', err));
          }
        });
        postDiv.appendChild(shareButton);

        const tagsElement = document.createElement('div');
        tagsElement.className = 'post-tags';
        if (tags) {
          const tagList = tags.split(',').map(tag => tag.trim());
          tagList.forEach(tag => {
            const tagSpan = document.createElement('span');
            tagSpan.textContent = tag;
            tagsElement.appendChild(tagSpan);
          });
        } else {
          tagsElement.textContent = 'No tags';
        }
        postDiv.appendChild(tagsElement);

        // Advertisement
        if (adsimage && aadsherflink && adsimage.trim() !== '' && aadsherflink.trim() !== '') {
          const adContainer = document.createElement('div');
          adContainer.className = 'ad-container';
          const adLink = document.createElement('a');
          adLink.href = aadsherflink;
          adLink.target = '_blank';
          adLink.rel = 'noopener noreferrer';
          adLink.addEventListener('click', (e) => {
            e.stopPropagation();
          });
          const adImage = document.createElement('img');
          adImage.src = adsimage;
          adImage.alt = 'Advertisement';
          adLink.appendChild(adImage);
          adContainer.appendChild(adLink);
          postDiv.appendChild(adContainer);
        }

        container.appendChild(postDiv);
      });
    }

    // Display error
    function displayError(message) {
      const container = document.getElementById('data-container');
      container.innerHTML = `<div class="error">${message}</div>`;
    }

    // Load data
    window.onload = () => {
      fetchSheetData();
      setupSearch();
    };
  </script>
  <script type="text/javascript"> var infolinks_pid = 3436212; var infolinks_wsid = 0; </script> <script type="text/javascript" src="//resources.infolinks.com/js/infolinks_main.js"></script>
</body>
</html>
